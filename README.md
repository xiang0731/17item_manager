# 17 物品管理系统 (17 Item Manager)

> 参考 Snipe-IT / Homebox / Grocy 设计的单文件 PHP 物品管理系统  
> 零配置部署，SQLite 数据库，适配 Synology NAS Web Station

---

## 功能概览

### 📊 仪表盘
- 五大统计卡片：物品种类、物品总数、分类数、位置数、总价值
- **过期提醒**：按过期时间排序展示，已过期 / 即将过期 / 正常三级颜色标识
- 最近更新物品列表（快速预览）
- 分类统计进度条（直观了解各分类占比）

### 📦 物品管理
- 卡片式网格展示，支持图片预览
- 完整字段：名称、分类、位置、数量、价格、购入日期、过期时间、购入渠道、备注、条码/序列号、标签、描述
- 自定义状态管理：预设使用中/已归档/已借出，支持新增/编辑/删除状态
- 按状态自动分组显示，空组隐藏
- 图片上传（支持 JPG / PNG / GIF / WebP，最大 10MB）
- 三种视图尺寸：大（卡片）/ 中（紧凑）/ 小（列表）
- **属性显示控制**：可自由勾选物品卡片中显示的属性（分类、位置、件数、价格、过期时间、购入渠道、备注）
- 多维度筛选：关键词搜索、分类、位置、状态
- 多种排序：最近更新 / 最近添加 / 名称 / 价格 / 数量
- 物品详情弹窗（点击卡片查看完整信息）
- 批量选择 + 批量删除（移入回收站）
- 分页浏览

### 🗑️ 回收站
- 删除的物品自动移入回收站（软删除），不会立即永久删除
- 回收站物品列表，显示物品信息和删除时间
- 单个恢复 / 全部恢复
- 单个彻底删除 / 清空回收站
- 物品关联图片同步移入 `data/uploads/trash/` 目录保存，恢复时自动移回
- 图片仅在清空回收站或彻底删除时才被永久移除
- 回收站入口位于物品管理视图内

### 🏷️ 分类管理
- 自定义分类名称、Emoji 图标、颜色
- 预设 8 个常用分类（电子设备、家具家居、厨房用品、衣物鞋帽、书籍文档、工具五金、运动户外、其他）
- 显示每个分类下的物品数量

### 📍 位置管理
- 支持父子层级关系（如：客厅 → 电视柜）
- 预设 6 个常用位置（客厅、卧室、厨房、书房、阳台、储物间）
- 位置描述和物品统计

### 🔄 数据导入 / 导出
- 导出 JSON 文件（完整备份，含物品、分类、位置）
- 导出 CSV 文件（方便 Excel 查看和编辑）
- 从 JSON 文件导入恢复

### 🎨 界面特性
- 深色 / 浅色主题一键切换，自动记忆偏好
- 毛玻璃 (Glassmorphism) 设计风格
- 全响应式布局，适配桌面和移动端
- 可折叠侧边栏（移动端自动收起）
- 平滑动画和 Toast 通知反馈

---

## 技术架构

| 项目 | 说明 |
|------|------|
| 部署方式 | 单文件 `index.php`，零配置 |
| 后端 | PHP + PDO |
| 数据库 | SQLite（自动创建于 `data/items_db.sqlite`） |
| 前端 | Tailwind CSS + RemixIcon + Vanilla JS |
| API 风格 | RESTful，通过 `?api=` 路由 |
| 依赖 | 无需 Composer，CSS/JS 通过 CDN 加载 |
| 环境兼容 | Synology NAS Web Station / Apache / Nginx |

---

## 文件结构

```
17ItemManager/
├── index.php          # 主程序（前后端一体）
├── test.php           # 环境检测脚本
├── README.md          # 项目说明文档
└── data/              # 运行时自动创建
    ├── items_db.sqlite    # SQLite 数据库
    └── uploads/           # 图片上传目录
        └── trash/         # 回收站图片暂存目录
```

---

## 部署方法

1. 将 `index.php` 放入 Web 服务器目录
2. 确保 PHP 已启用 `pdo_sqlite` 扩展（可用 `test.php` 检测）
3. 确保目录可写（用于创建数据库和上传图片）
4. 浏览器直接访问 `index.php` 即可，首次访问自动初始化

---

## 更新记录

### v1.9.0 — 2026-02-08
**✏️ 状态编辑 + 属性显示控制 + 件数位置调整**
- 状态管理支持编辑已有状态（名称、图标、颜色），标识不可修改
- 物品管理新增「属性」下拉按钮，可勾选物品卡片中显示的属性字段
- 支持的可选属性：分类、位置、件数、价格、过期时间、购入渠道、备注
- 属性显示设置保存到本地存储，默认显示位置和过期时间
- 物品卡片中件数显示位置调整到分类前面（大/中/小三种视图）
- 修复「其他」状态分组使用硬编码 key 的问题

### v1.8.0 — 2026-02-08
**🏷️ 分类查看物品 + 状态管理 + 新增物品属性**
- 分类管理添加「物品」按钮，跳转物品管理并应用分类过滤
- 新增状态管理设置，支持自定义物品状态（新增/删除）
- 物品新增「购入渠道」和「备注」属性
- 物品表单布局优化为3列网格，弹窗宽度增加到720px

### v1.7.0 — 2026-02-08
**📋 物品状态分组 + 过期显示 + 缩略图**
- 物品管理按状态分组显示，空组自动隐藏
- 物品卡片和列表显示过期时间
- 小尺寸列表显示物品缩略图
- 修复中尺寸按钮图标缺失

### v1.6.0 — 2026-02-08
**📐 仪表盘布局优化 + 物品视图大小**
- 仪表盘统计改为紧凑行内布局，更适合移动端
- 最近更新区域优化显示密度
- 物品管理新增大/中/小三种显示尺寸切换

### v1.5.0 — 2026-02-08
**⚙️ 侧边栏设置菜单重构**
- 侧边栏新增「设置」父菜单，支持点击展开/收起
- 「导入/导出」「排序设置」「更新记录」收纳为二级子菜单
- 更新记录拆分为独立页面（不再嵌入排序设置内）
- 切换到设置子页面时菜单自动展开

### v1.4.0 — 2026-02-08
**🔍 回收站详情 + 位置查看物品 + 更新记录**
- 回收站物品可点击查看完整详情（图片、分类、位置、价值、标签、删除时间等）
- 位置管理每个位置新增「物品」按钮，点击跳转物品管理并自动应用位置筛选
- 排序设置页面下方新增「更新记录」板块，展示版本历史
- 左上角 Logo 旁显示当前版本号，自动取更新记录中的最新版本

### v1.3.0 — 2026-02-08
**🗑️ 回收站功能**
- 新增「回收站」视图，入口位于物品管理页面内
- 删除物品改为软删除（`deleted_at` 字段），物品移入回收站而非永久删除
- 物品关联图片同步移入 `data/uploads/trash/` 目录保存
- 回收站支持：单个恢复、全部恢复、单个彻底删除、清空回收站
- 恢复物品时图片自动从 `uploads/trash/` 移回 `uploads/`
- 回收站物品可点击查看完整详情信息
- 所有常规查询（仪表盘、物品列表、分类统计、位置统计、导出等）自动过滤已删除物品
- 自动数据库迁移：旧数据库自动添加 `deleted_at` 字段

### v1.2.0 — 2026-02-08
**⚙️ 排序设置 + 复制物品 + 仪表盘优化**
- 新增「排序设置」页面，可自定义以下列表的默认排序方式：
  - 仪表盘分类统计（按种类数 / 按总件数 / 按名称首字母）
  - 物品管理默认排序（最近更新 / 最近添加 / 名称 / 价格 / 数量）
  - 分类管理列表排序（默认顺序 / 按物品数 / 按名称）
  - 位置管理列表排序（默认顺序 / 按物品数 / 按名称）
- 排序设置通过 localStorage 持久化保存
- 新增「复制物品」功能：一键复制现有物品的全部资料到新建表单
- 仪表盘分类统计自动隐藏无物品的空分类

### v1.1.0 — 2026-02-08
**🆕 新增过期时间 + 修复编辑 Bug**
- 新增「过期时间」字段，支持在物品表单中设置
- 仪表盘新增「过期提醒」板块，按过期时间升序排列
- 过期状态三级视觉标识：已过期(红) / 7天内(橙) / 30天内(黄) / 正常(绿)
- 物品详情弹窗显示过期时间及剩余天数
- CSV 导出新增过期时间列
- 修复：编辑物品时分类和位置下拉框未正确显示原有值的 Bug
- 自动数据库迁移：旧数据库自动添加 `expiry_date` 字段

### v1.0.0 — 2026-02-08
**🎉 初始版本发布**
- 完整的物品 CRUD（增删改查）功能
- 仪表盘统计面板（5 项核心指标 + 分类进度条）
- 分类管理（Emoji 图标 + 自定义颜色，预设 8 个常用分类）
- 位置管理（支持父子层级，预设 6 个常用位置）
- 图片上传与预览（支持 JPG / PNG / GIF / WebP）
- 全局搜索 + 多维度筛选 + 多种排序
- 物品详情弹窗
- 批量选择与批量删除
- 分页浏览
- 数据导出（JSON / CSV）与导入
- 深色 / 浅色主题切换
- 全响应式布局（桌面 + 移动端）
- 毛玻璃 UI 风格，动画与 Toast 通知

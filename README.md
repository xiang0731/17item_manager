# 17 物品管理系统 (17 Item Manager) 

> 参考 Snipe-IT / Homebox / Grocy 设计的单文件 PHP 物品管理系统  
> 零配置部署，SQLite 数据库，适配 Synology NAS Web Station

---

## 功能概览

### 📊 仪表盘
- 五大统计卡片：物品种类、物品总数、分类数、位置数、总价值
- **过期提醒**：按过期日期排序展示，已过期 / 即将过期 / 正常三级颜色标识
- 最近更新物品列表（快速预览）
- 状态统计（自动隐藏 0 数据状态）
- 分类统计进度条（仅统计使用中物品），右上角显示未分类件数

### 📦 物品管理
- 卡片式网格展示，支持图片预览
- 完整字段：名称、分类、位置、数量、价格、购入日期、过期日期、购入渠道、备注、条码/序列号、标签、描述
- 自定义状态管理：预设使用中/已归档/已转卖，支持新增/编辑/删除状态（英文标识 + 中文显示）
- 按状态自动分组显示，空组隐藏
- 图片上传（支持 JPG / PNG / GIF / WebP，最大 10MB）
- 三种视图尺寸：大（卡片）/ 中（紧凑）/ 小（列表）
- **属性显示控制**：可自由勾选物品卡片中显示的属性（分类、位置、件数、价格、过期日期、购入渠道、备注）
- **过期管理过滤器**：一键筛选仅显示设置过过期日期的物品
- 多维度筛选：关键词搜索、分类、位置、状态
- 多种排序：最近更新 / 最近添加 / 名称 / 价格 / 数量
- 物品详情弹窗（点击卡片查看完整信息）
- 批量选择 + 批量删除（移入回收站）
- 分页浏览

### 🗑️ 回收站
- 删除的物品自动移入回收站（软删除），不会立即永久删除
- 回收站物品列表，显示物品信息和删除时间
- 单个恢复 / 全部恢复
- 单个彻底删除 / 清空回收站
- 物品关联图片同步移入 `data/uploads/trash/` 目录保存，恢复时自动移回
- 图片仅在清空回收站或彻底删除时才被永久移除
- 回收站入口位于物品管理视图内

### 🏷️ 分类管理
- 自定义分类名称、Emoji 图标、颜色
- 预设 8 个常用分类（电子设备、家具家居、厨房用品、衣物鞋帽、书籍文档、工具五金、运动户外、其他）
- 显示每个分类下的物品数量

### 📍 位置管理
- 单级位置管理（所有位置同一层级）
- 预设 6 个常用位置（客厅、卧室、厨房、书房、阳台、储物间）
- 位置描述和物品统计

### 🔄 数据管理
- 导出 JSON 文件（完整备份，含物品、分类、位置；文件名精确到秒）
- 可选同时导出图片数据（嵌入式 Base64）
- 导出 CSV 文件（方便 Excel 查看和编辑）
- 从 JSON 文件导入恢复（支持带内置图片数据）
- 手动批量导入：下载默认 Excel 模板（CSV）后批量导入
- 批量导入日期校验：支持 `YYYY-MM-DD` / `YYYY/MM/DD`（如 `2026/2/9`），不合规行自动跳过并给出可手动关闭提示
- 导入模糊匹配：分类/位置/购入渠道/状态支持模糊匹配已有值，不存在时使用默认值
- 数据管理内置「物品数据重置」与「恢复默认环境」

### 🎨 界面特性
- 深色 / 浅色主题一键切换，自动记忆偏好
- 毛玻璃 (Glassmorphism) 设计风格
- 全响应式布局，适配桌面和移动端
- 可折叠侧边栏（移动端自动收起）
- 平滑动画和 Toast 通知反馈

---

## 技术架构

| 项目     | 说明                                        |
| -------- | ------------------------------------------- |
| 部署方式 | 单文件 `index.php`，零配置                  |
| 后端     | PHP + PDO                                   |
| 数据库   | SQLite（自动创建于 `data/items_db.sqlite`） |
| 前端     | Tailwind CSS + RemixIcon + Vanilla JS       |
| API 风格 | RESTful，通过 `?api=` 路由                  |
| 依赖     | 无需 Composer，CSS/JS 通过 CDN 加载         |
| 环境兼容 | Synology NAS Web Station / Apache / Nginx   |

---

## 文件结构

```
17ItemManager/
├── index.php          # 主程序（前后端一体）
├── test.php           # 环境检测脚本
├── README.md          # 项目说明文档
└── data/              # 运行时自动创建
    ├── items_db.sqlite    # SQLite 数据库
    └── uploads/           # 图片上传目录
        └── trash/         # 回收站图片暂存目录
```

---

## 部署方法

1. 将 `index.php` 放入 Web 服务器目录
2. 确保 PHP 已启用 `pdo_sqlite` 扩展（可用 `test.php` 检测）
3. 确保目录可写（用于创建数据库和上传图片）
4. 浏览器直接访问 `index.php` 即可，首次访问自动初始化

---

## 更新记录

### v1.2.0 — 2026-02-09
**🧩 数据管理增强 + 批量导入完善 + 仪表盘优化**
- 设置菜单中的「导入/导出」统一改名为「数据管理」
- 新增「物品数据重置」与「恢复默认环境」
- 执行重置时，`uploads/` 中关联图片移动到 `uploads/trash/`，不直接删除原图
- 数据管理新增「展示模式」，可一键导入演示数据用于功能展示
- 新增购入渠道管理（默认：淘宝/京东/拼多多/闲鱼/线下/礼品），添加/编辑物品改为下拉选择
- 移除位置上下级功能，位置管理统一为单级结构
- 分类管理固定显示「未分类」、位置管理固定显示「未设定」，并支持一键查看对应物品
- 物品管理过滤器新增「未分类 / 未设定」选项，便于筛出未绑定分类或位置的物品
- 物品管理新增「过期管理」过滤按钮（仅显示带过期日期的物品）
- 物品管理搜索栏支持属性关键词检索（分类/位置/购入渠道/备注/状态等），支持搜索按钮和 Enter 触发
- 物品排序新增名称 Z-A、价格低→高、数量少→多、最早更新/添加、过期日期近→远与远→近（空过期日期自动置后）
- 分类管理与位置管理新增排序按钮；下拉层级遮挡问题已修复，并默认跟随系统排序设置
- 导出 JSON 文件名增加详细时间（精确到秒），并支持可选导出图片数据
- 导入 JSON 支持读取内置图片数据
- 新增手动批量导入（CSV 模板），模板内示例标注必填/可选，日期格式统一为 `YYYY/MM/DD`
- 批量导入日期验证支持 `YYYY-MM-DD` 与 `YYYY/MM/DD`（含单数字月/日），错误行跳过并给出持久提示
- 导入时分类/位置/购入渠道/状态支持模糊匹配已有值，不存在时自动回退默认值
- 仪表盘新增状态统计（0 数据状态隐藏），分类统计右上角显示未分类件数，分类统计仅统计使用中物品
- 仪表盘「过期提醒」「状态统计」在无数据时也保持显示空态，不再整块隐藏
- 浅色模式下优化过期提醒卡片与时间文本、分类进度条背景，降低突兀感
- 状态图标选择器支持可视化图标下拉（图标+名称）

### v1.1.0 — 2026-02-08
**🧱 核心功能完善与交互优化（整合 v1.1 ~ v2.0）**
- 新增「过期日期」字段，支持在物品表单中设置
- 仪表盘新增「过期提醒」板块与过期状态三级视觉标识
- 新增「排序设置」页面，可自定义仪表盘/物品/分类/位置排序并持久化
- 新增「复制物品」功能，支持从现有物品快速创建
- 新增「回收站」软删除流程（恢复/彻底删除/清空）与回收站详情
- 分类管理与位置管理新增「物品」按钮，支持一键跳转并筛选
- 侧边栏重构为「设置」父菜单，更新记录独立页面，左上角显示版本号
- 仪表盘布局与最近更新区优化，新增物品视图大小切换（大/中/小）
- 物品管理支持按状态分组显示，空组自动隐藏
- 新增状态管理（新增/删除）并支持状态编辑（名称/图标/颜色）
- 新增属性显示控制（分类、位置、件数、价格、过期日期、购入渠道、备注）
- 物品新增购入渠道与备注字段，表单布局优化
- 新增筛选重置按钮、属性按钮样式优化与交互性能优化
- 修复编辑回填与中尺寸图标显示等问题
- 自动数据库迁移：旧数据库自动添加 `expiry_date` 字段

### v1.0.0 — 2026-02-08
**🎉 初始版本发布**
- 完整的物品 CRUD（增删改查）功能
- 仪表盘统计面板（5 项核心指标 + 分类进度条）
- 分类管理（Emoji 图标 + 自定义颜色，预设 8 个常用分类）
- 位置管理（单级结构，预设 6 个常用位置）
- 图片上传与预览（支持 JPG / PNG / GIF / WebP）
- 全局搜索 + 多维度筛选 + 多种排序
- 物品详情弹窗
- 批量选择与批量删除
- 分页浏览
- 数据导出（JSON / CSV）与导入
- 深色 / 浅色主题切换
- 全响应式布局（桌面 + 移动端）
- 毛玻璃 UI 风格，动画与 Toast 通知
